<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dashboard de Visitas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Tailwind CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

    <!-- ApexCharts CDN -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.46.0/dist/apexcharts.min.js"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen">

<div class="max-w-6xl mx-auto px-4 py-6">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6">
        <h1 class="text-3xl font-bold">Dashboard de Visitas</h1>
        <div class="flex gap-2 flex-wrap">
            <button id="scroll-registros"
                    class="inline-flex items-center justify-center px-4 py-2 rounded-lg bg-indigo-600 hover:bg-indigo-700 text-sm font-medium">
                Ver registros
            </button>

            <!-- Botón para ir a la página de CRUD -->
            <a href="./crud.html"
               class="inline-flex items-center justify-center px-4 py-2 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-sm font-medium">
                Gestión de registros (CRUD)
            </a>

            <button id="logout-btn"
                    class="inline-flex items-center justify-center px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-sm font-medium">
                Cerrar sesión
            </button>
        </div>
    </div>

    <!-- Métricas -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <div class="bg-gray-800 border border-gray-700 rounded-lg shadow p-4">
            <p class="text-sm text-gray-400">Visitas totales</p>
            <p id="total-visitas" class="mt-2 text-2xl font-bold">-</p>
        </div>
        <div class="bg-gray-800 border border-gray-700 rounded-lg shadow p-4">
            <p class="text-sm text-gray-400">Visitas hoy</p>
            <p id="visitas-hoy" class="mt-2 text-2xl font-bold">-</p>
        </div>
        <div class="bg-gray-800 border border-gray-700 rounded-lg shadow p-4">
            <p class="text-sm text-gray-400">Visitas activas</p>
            <p id="visitas-activas" class="mt-2 text-2xl font-bold">-</p>
        </div>
    </div>

    <!-- Gráficos -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <!-- Visitas por día -->
        <div class="bg-gray-800 border border-gray-700 rounded-lg shadow p-4 md:p-6">
            <div class="flex items-center justify-between mb-4">
                <div>
                    <h2 class="text-lg font-semibold">Visitas por día</h2>
                    <p class="text-xs text-gray-400">Últimos 7 días</p>
                </div>
            </div>
            <div class="mt-2" id="visitasPorDiaChart"></div>
        </div>

        <!-- Estado de visitas -->
        <div class="bg-gray-800 border border-gray-700 rounded-lg shadow p-4 md:p-6">
            <div class="flex items-center justify-between mb-4">
                <div>
                    <h2 class="text-lg font-semibold">Estado de las visitas</h2>
                    <p class="text-xs text-gray-400">Finalizadas vs. incompletas</p>
                </div>
            </div>
            <div class="mt-2" id="estadoVisitasChart"></div>
        </div>
    </div>

    <!-- TABLA DE REGISTROS -->
    <section id="seccion-registros" class="space-y-4">
        <!-- Título -->
        <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
            <h2 class="text-2xl font-bold">Lista de registros</h2>
        </div>

        <!-- Buscador global + entries per page -->
        <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
            <div class="relative w-full sm:max-w-xs">
                <input id="search-global" type="text"
                       class="w-full rounded-lg border border-gray-700 bg-gray-800 px-3 py-2 text-sm text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"
                       placeholder="Buscar por nombre, RUT o motivo...">
            </div>

            <div class="flex items-center gap-2 text-sm text-gray-300">
                <span>Mostrar</span>
                <select id="page-size"
                        class="rounded-lg border border-gray-700 bg-gray-800 px-2 py-1 text-sm text-gray-100">
                    <option value="10">10</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                </select>
                <span>registros</span>
            </div>
        </div>

        <!-- Tabla -->
        <div class="relative overflow-x-auto bg-gray-800 rounded-lg shadow border border-gray-700">
            <table class="w-full text-sm text-left border-separate border-spacing-0">
                <thead class="bg-gray-800 text-gray-300">
                <!-- Encabezados con orden -->
                <tr class="border-b border-gray-700 text-xs uppercase tracking-wide">
                    <th data-sort="nombre" class="px-6 py-3 font-semibold cursor-pointer select-none">
                        <div class="flex items-center gap-1">
                            <span>Nombre</span>
                            <span class="flex flex-col leading-none text-[9px]" data-sort-icons>
                                <span data-arrow="up">▲</span>
                                <span data-arrow="down">▼</span>
                            </span>
                        </div>
                    </th>
                    <th data-sort="rut" class="px-6 py-3 font-semibold cursor-pointer select-none">
                        <div class="flex items-center gap-1">
                            <span>RUT</span>
                            <span class="flex flex-col leading-none text-[9px]" data-sort-icons>
                                <span data-arrow="up">▲</span>
                                <span data-arrow="down">▼</span>
                            </span>
                        </div>
                    </th>
                    <th data-sort="motivo" class="px-6 py-3 font-semibold cursor-pointer select-none">
                        <div class="flex items-center gap-1">
                            <span>Motivo</span>
                            <span class="flex flex-col leading-none text-[9px]" data-sort-icons>
                                <span data-arrow="up">▲</span>
                                <span data-arrow="down">▼</span>
                            </span>
                        </div>
                    </th>
                    <th data-sort="horaentrada" class="px-6 py-3 font-semibold cursor-pointer select-none">
                        <div class="flex items-center gap-1">
                            <span>Hora Entrada</span>
                            <span class="flex flex-col leading-none text-[9px]" data-sort-icons>
                                <span data-arrow="up">▲</span>
                                <span data-arrow="down">▼</span>
                            </span>
                        </div>
                    </th>
                    <th data-sort="horasalida" class="px-6 py-3 font-semibold cursor-pointer select-none">
                        <div class="flex items-center gap-1">
                            <span>Hora Salida</span>
                            <span class="flex flex-col leading-none text-[9px]" data-sort-icons>
                                <span data-arrow="up">▲</span>
                                <span data-arrow="down">▼</span>
                            </span>
                        </div>
                    </th>
                    <th data-sort="estado" class="px-6 py-3 font-semibold cursor-pointer select-none">
                        <div class="flex items-center gap-1">
                            <span>Estado</span>
                            <span class="flex flex-col leading-none text-[9px]" data-sort-icons>
                                <span data-arrow="up">▲</span>
                                <span data-arrow="down">▼</span>
                            </span>
                        </div>
                    </th>
                </tr>

                <!-- Fila de filtros por columna -->
                <tr class="border-b border-gray-700 text-xs">
                    <th class="px-6 py-2">
                        <input id="filter-nombre" type="text"
                               class="w-full rounded-md border border-gray-700 bg-gray-900/60 px-2 py-1 text-xs text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"
                               placeholder="Filtrar nombre">
                    </th>
                    <th class="px-6 py-2">
                        <input id="filter-rut" type="text"
                               class="w-full rounded-md border border-gray-700 bg-gray-900/60 px-2 py-1 text-xs text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"
                               placeholder="Filtrar RUT">
                    </th>
                    <th class="px-6 py-2">
                        <input id="filter-motivo" type="text"
                               class="w-full rounded-md border border-gray-700 bg-gray-900/60 px-2 py-1 text-xs text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"
                               placeholder="Filtrar motivo">
                    </th>
                    <th class="px-6 py-2"></th>
                    <th class="px-6 py-2"></th>
                    <th class="px-6 py-2">
                        <select id="filter-estado"
                                class="w-full rounded-md border border-gray-700 bg-gray-900/60 px-2 py-1 text-xs text-gray-100">
                            <option value="">Todos</option>
                            <option value="finalizado">Finalizado</option>
                            <option value="incompleto">Incompleto</option>
                        </select>
                    </th>
                </tr>
                </thead>

                <tbody id="registros-list" class="divide-y divide-gray-700">
                <!-- filas generadas por JS -->
                </tbody>
            </table>

            <!-- Paginación -->
            <div class="flex flex-col gap-3 px-4 py-3 sm:flex-row sm:items-center sm:justify-between text-xs text-gray-400">
                <div>
                    Mostrando
                    <span id="page-start">0</span> -
                    <span id="page-end">0</span>
                    de
                    <span id="page-total">0</span>
                    registros
                </div>
                <div class="inline-flex overflow-hidden rounded-md border border-gray-700">
                    <button id="prev-page"
                            class="px-3 py-1.5 bg-gray-800 hover:bg-gray-700 transition disabled:opacity-40 disabled:cursor-not-allowed">
                        Anterior
                    </button>
                    <button id="next-page"
                            class="border-l border-gray-700 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 transition disabled:opacity-40 disabled:cursor-not-allowed">
                        Siguiente
                    </button>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- JS externo (en carpeta js/) -->
<script src="./js/dashboard.js"></script>
</body>
</html>